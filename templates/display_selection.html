{% extends 'base.html' %}

{% block content %}

<form action='/query?key_word={{key_word}}'>
	<input type='submit' value='Query Results'>
</form>

<h3>Video</h3>

<iframe src={{ video }} width="640" height="360" frameborder="0" scrolling="no" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>

<h3>Transcript</h3>
	{% for para in webpage_transcript %}
		<p>{{webpage_transcript[para]}}</p>
	{% endfor %}
<br>
<br>
<h3>Vocabulary Chart</h3>
	<p>Double-click on the vocabulary to store it in your list.</p>
	
	{% for word in vocab_list %}
	<table class="vocab_chart toggle_chart" id="toggle-{{word.word_id}}">
		<thead>
				<tr class="">
					<th>Vocab</th>
					<th>Parts of speech</th>
					<th>Pronunciation</th>
					<th>Selection</th>
				</tr>
		</thead>
		
		<tbody>
	
			<tr class="">
				<td><div class='word_list' id="{{word.word_id}}">{{word.word}}</div></td>
				<td>{% for part in parts_of_speech_sets[word.word] %}
					{{part}}
					<br>
					{% endfor %}
				</td>
				<td><a href='{{word.pronunciation}}' target="_blank" id="sound_popup">Pronounce it!</a></td>
				<td>{{word.selection}}</td>	
			</tr>

			<tr class="hidden_vocab_info hidden-toggle-{{word.word_id}}">
				<td><b>Definition</b></td>
				<td colspan="3">  {% for entry in definition_sets[word.word] %}
								{{entry}}
								{% endfor %}
				</td>
			</tr>
			<tr class="hidden_vocab_info hidden-toggle-{{word.word_id}}">
				<td><b>Example Sentence (Ted Talk)</b></td>
				<td colspan="3">{{word.sentence}}</td>
			</tr>

			<tr class="hidden_vocab_info hidden-toggle-{{word.word_id}}">
				<td><b>Example Sentence (NY Times)</b></td>
				<td colspan="3">{{word.other_usage}}    <button type="button">
					<a href='{{word.other_usage_link}}'target="_blank">source</a>
					</button>
				</td>
			</tr>
		
		</tbody>
	</table>
	<br>
	{% endfor%}
	
	<form action='/vocab_exercise' method='post'>
		{% set count = 1 %}
		{% for word in vocab_list %}
			<input type="hidden" name='word{{count}}' value='{{word.word_id}}'>
			{% set count = count + 1 %}
		{% endfor %}
		<input type="hidden" name="key_word", value="{{key_word}}">
		<input type="hidden" name="slug", value="{{slug}}">
		<input type="hidden" name="talk_id", value="{{talk_id}}">
		<input type="submit" value="Work on Vocab Exercises!">
	</form>


	<script src="http://code.jquery.com/jquery.js"></script>

	<script>
	
	// store vocab to personal list
	storeVocab = function(){
		$.post('/store_vocab', {'word_id':this.id}, function(data){
			alert(data);
			}
		);
	}
	var word_list = $('.word_list');

	for (var i=0; i < word_list.length; i++){
		$(word_list[i]).on('dblclick', storeVocab);
	}
	
	
	// toggle each vocab chart to show more info
	var hidden_vocab_info = $('.hidden_vocab_info');
	$(hidden_vocab_info).hide();
	
	var toggle_chart = $('.toggle_chart');
	
	toggleVocabChart = function() {
		console.log("This is running");
		console.log($(this.id));
		$(".hidden-"+this.id).toggle();
	}

	for (var i=0; i<toggle_chart.length; i++){
		$(toggle_chart[i]).on('click', toggleVocabChart);
	}
	// fetech new york times sentence only when needed 
	
	// fetchNySentence = function(){
	// 	$.post('fetch_ny_sentence', {word_id: this.id}, function(data) {
	// 		}
	// 	);
	// }
	// $(".toggle_chart").on('click', fetchNySentence);
	

	// write javascript to pop up the pronunciation window
	// popUpSound = function(evt) {
	// 	evt.preventDefault()
	// }
	// var sound_popup = $("#sound_popup").on('click', popUpSound)
	</script>
	
{% endblock %}

	







